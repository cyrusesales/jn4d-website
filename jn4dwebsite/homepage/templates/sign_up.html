{% extends "base.html" %} 
{% block title %}Sign Up{% endblock %}
{% block content %}
<link
  href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css"
  rel="stylesheet"
/>

<link rel="stylesheet"
 href="https://cdn.jsdelivr.net/npm/intl-tel-input@18.5.2/build/css/intlTelInput.css"/>

<script src="https://cdn.jsdelivr.net/npm/intl-tel-input@18.5.2/build/js/intlTelInput.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/intl-tel-input@18.5.2/build/js/utils.js"></script>



<script
  src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
  crossorigin="anonymous"
></script>

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;" >
  <symbol id="save" viewBox="0 0 16 16" fill="currentColor">
    <path d="M0 1.5A1.5 1.5 0 0 1 1.5 0H3v5.5A1.5 1.5 0 0 0 4.5 7h7A1.5 1.5 0 0 0 13 5.5V0h.086a1.5 1.5 0 0 1 1.06.44l1.415 1.414A1.5 1.5 0 0 1 16 2.914V14.5a1.5 1.5 0 0 1-1.5 1.5H14v-5.5A1.5 1.5 0 0 0 12.5 9h-9A1.5 1.5 0 0 0 2 10.5V16h-.5A1.5 1.5 0 0 1 0 14.5z"/>
  <path d="M3 16h10v-5.5a.5.5 0 0 0-.5-.5h-9a.5.5 0 0 0-.5.5zm9-16H4v5.5a.5.5 0 0 0 .5.5h7a.5.5 0 0 0 .5-.5zM9 1h2v4H9z"/>
  </symbol>
  <symbol id="back" viewBox="0 0 16 16" fill="currentColor">
    <path d="M.5 3.5A.5.5 0 0 0 0 4v8a.5.5 0 0 0 1 0V8.753l6.267 3.636c.54.313 1.233-.066 1.233-.697v-2.94l6.267 3.636c.54.314 1.233-.065 1.233-.696V4.308c0-.63-.693-1.01-1.233-.696L8.5 7.248v-2.94c0-.63-.692-1.01-1.233-.696L1 7.248V4a.5.5 0 0 0-.5-.5"/>
  </symbol>
  <symbol id="warning" viewBox="0 0 16 16" fill="currentColor">
    <path d="M7.938 2.016A.13.13 0 0 1 8.002 2a.13.13 0 0 1 .063.016.15.15 0 0 1 .054.057l6.857 11.667c.036.06.035.124.002.183a.2.2 0 0 1-.054.06.1.1 0 0 1-.066.017H1.146a.1.1 0 0 1-.066-.017.2.2 0 0 1-.054-.06.18.18 0 0 1 .002-.183L7.884 2.073a.15.15 0 0 1 .054-.057m1.044-.45a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767z"/>
    <path d="M7.002 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0M7.1 5.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0z"/>
  </symbol>
  <symbol id="closeEye" viewBox="0 0 16 16" fill="currentColor">
    <path d="M13.359 11.238C15.06 9.72 16 8 16 8s-3-5.5-8-5.5a7 7 0 0 0-2.79.588l.77.771A6 6 0 0 1 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755q-.247.248-.517.486z"/>
    <path d="M11.297 9.176a3.5 3.5 0 0 0-4.474-4.474l.823.823a2.5 2.5 0 0 1 2.829 2.829zm-2.943 1.299.822.822a3.5 3.5 0 0 1-4.474-4.474l.823.823a2.5 2.5 0 0 0 2.829 2.829"/>
    <path d="M3.35 5.47q-.27.24-.518.487A13 13 0 0 0 1.172 8l.195.288c.335.48.83 1.12 1.465 1.755C4.121 11.332 5.881 12.5 8 12.5c.716 0 1.39-.133 2.02-.36l.77.772A7 7 0 0 1 8 13.5C3 13.5 0 8 0 8s.939-1.721 2.641-3.238l.708.709zm10.296 8.884-12-12 .708-.708 12 12z"/>
  </symbol>
  <symbol id="success" viewBox="0 0 16 16" fill="currentColor">
    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/>
    <path d="m10.97 4.97-.02.022-3.473 4.425-2.093-2.094a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-1.071-1.05"/>
  </symbol>

</svg>

<style>
.iti {
    width: 100%;
}

.iti--left .iti__flag-container {
    left: auto;
    right: 0;
}

.iti--left input {
    padding-left: 12px !important;
    padding-right: 95px !important;
}

.iti--left .iti__selected-flag {
    justify-content: flex-end;
}
</style>

<section class="section">
  <div class="container">
    <div class="row justify-content-center" style="margin-top: 80px; margin-bottom: 50px">
      <div class="col-md-8 mt-5">
        <div class="card">
          <div class="card-header">
            <h3 class="fw">Create Account</h3>
          </div>
          <div class="card-body">
            <form action="" method="POST" enctype="multipart/form-data">
              {% csrf_token %}
              
              <div class="form-floating mb-3">
                <input type="text" name="firstName" class="form-control" id="firstname" placeholder="First Name" required>
                <label for="">First Name</label>
              </div>
              <div class="form-floating mb-3">
                <input type="text" name="lastName" class="form-control" id="lastname" placeholder="Last Name" required>
                <label for="">Last Name</label>
              </div>
              <div class="form-floating mb-3">
                <input type="email" name="email" class="form-control" id="email" placeholder="Email" required>
                <label for="">Email Address</label>
              </div>
              <div class="form-floating mb-3">
                <input type="password" name="password" class="form-control" id="password" placeholder="Password" required>
                <label for="">Password</label>
                <input type="checkbox" name="" id="" onclick="myFunction()"> Show Password
              </div>
              <div class="form-floating mb-3">
                <input type="date" name="dateOfBirth" class="form-control" id="dateOfBirth" placeholder="Date of Birth" required>
                <label for="">Date of Birth</label>
              </div>
              <label class="">Phone Number</label>
              <div class="form-floating mb-3">
                <input type="tel" name="phone" class="form-control" id="phone" required>
                <div class="invalid-feedback">
                    Please enter a valid phone number.
                </div>
                <div class="valid-feedback">
                    Phone number looks good!
                </div>
                
              </div>
              <input type="hidden" name="full_phone" id="full_phone">
              <br>

              <!--Buttons Below-->
              <button type="submit" class="btn btn-success">
                {% comment %} <svg class="bi m-2" width="18" height="18">
                  <use xlink:href="#save"><!--Save--></use>
                </svg> {% endcomment %}
                Create Account
              </button>
              {% comment %} <button type="button" class="btn btn-danger px-0 py-0" data-bs-toggle="modal" data-bs-target="#staticBackdrop-{{ headers.id }}" >
                    <svg class="bi m-2" width="16" height="16">
                    <use xlink:href="#delete"></use>
                    </svg>
                    <!--Delete-->
              </button> {% endcomment %}
                <!--Modal-->
                {% if messages %}
                <div class="modal fade" id="messageModal" tabindex="-1">
                    <div class="modal-dialog modal-dialog-centered modal-sm">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">Message</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>
                            {% for message in messages %}
                                {% if message.tags == 'warning' %}
                                    <div class="modal-body" id="modalMessageBody">
                                        <svg class="bi m-2" width="24" height="24">
                                            <use xlink:href="#warning"></use>
                                        </svg> {{ message }}
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" >
                                            Close
                                        </button>
                                    </div>
                                {% else %}
                                    <div class="modal-body" id="modalMessageBody">
                                        <svg class="bi m-2" width="24" height="24">
                                            <use xlink:href="#success"></use>
                                        </svg> {{ message }}
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" >
                                            Close
                                        </button>
                                        <a href="{% url "homepage" %}" class="btn btn-success">Login</a>
                                    </div>
                                {% endif %}
                            {% endfor %}
                        </div>
                    </div>
                </div>
                {% endif %}


              <a href="{% url "homepage" %}" class="btn btn-secondary">
                {% comment %} <svg class="bi m-2" width="18" height="18">
                  <use xlink:href="#back"><!--Back--></use>
                </svg> {% endcomment %}
                Cancel
              </a>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>





{% if messages %}
<script>
  document.addEventListener("DOMContentLoaded", function () {
      var modal = new bootstrap.Modal(document.getElementById("messageModal"));
      modal.show();
  });
</script>
{% endif %} 


<script>
//Password Input
function myFunction(){
    var x = document.getElementById("password");
    if (x.type === "password"){
        x.type = "text";
    } else {
        x.type = "password";
    }
}

//Phone Number Input
const phoneInput = document.querySelector("#phone");
const hiddenPhone = document.querySelector("#full_phone");

const iti = window.intlTelInput(phoneInput, {
    separateDialCode: true,
    initialCountry: "ph",
    preferredCountries: ["ph"],

    autoPlaceholder: "off",


    utilsScript:
      "https://cdn.jsdelivr.net/npm/intl-tel-input@18.5.2/build/js/utils.js",
});

// force dropdown right
phoneInput.closest(".mb-3")
    .querySelector(".iti")
    .classList.add("iti--right");

function normalizePHNumber(){
    const country = iti.getSelectedCountryData().iso2;

    if (country === "ph" && !phoneInput.value.startsWith("9")){
        //phoneInput.value = phoneInput.value.replace(/^0+/, '')
        phoneInput.classList.add("is-invalid");
        return;
    }
}

// validate live
const validatePhone = () => {
    normalizePHNumber();

    if (phoneInput.value.trim() === "") {
        phoneInput.classList.remove("is-valid", "is-invalid");
        hiddenPhone.value = "";
        return;
    }

    if (iti.isValidNumber()) {
        phoneInput.classList.add("is-valid");
        phoneInput.classList.remove("is-invalid");
        hiddenPhone.value = iti.getNumber(); // E.164
    } else {
        phoneInput.classList.add("is-invalid");
        phoneInput.classList.remove("is-valid");
        hiddenPhone.value = "";
    }
};

//phoneInput.addEventListener("keyup", validatePhone);
//phoneInput.addEventListener("blur", validatePhone);
phoneInput.addEventListener("input", validatePhone);
phoneInput.addEventListener("countrychange", validatePhone);
</script>

{% endblock %}